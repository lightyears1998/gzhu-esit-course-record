---
title: 任务0：建立开发环境
date: 2020-03-10 08:38:26
tags: env
---

受到新冠肺炎的影响，学校禁止学生返校，课程进行远程教学。指导本课程的金老师在周一时和我们在线上通过腾讯课堂进行了第一次课，并让我们在下周搭建好课程所需要的开发环境。

课程所需的工具之一是[GNU Compiler Collection](https://gcc.gnu.org/)，主要会用到GCC中C语言相关功能。考虑到多数同学使用的Windows操作系统上没有GCC，金老师建议我们使用基于Linux内核的云主机，或者在Windows系统上安装虚拟机。

我自己的主力操作系统是Windows 10，近几天升级到了Insider测试中的2004版本。私以为，如果只是单纯地需要GCC，除金老师的建议外，还有“在Windows上使用Linux子系统”以及“在Windows上使用MSYS2”两种简单易行的方案。不过，这两种方案很可能会有坑点。

下面简要记录使用各个方案搭建环境的步骤。

## 使用基于linux内核的云主机

### 选购云服务器

[阿里云](https://promotion.aliyun.com/ntms/act/campus2018.html)和[腾讯云](https://cloud.tencent.com/act/campus)都提供基于Linux内核的云主机，并且都向学生提供优惠，基本版的云服务器月付人民币10元以下，提供一个公网IP、1Mbps的公网带宽、2GB内存以及足够大的磁盘空间。

完成学生认证就可以享受学生优惠了。我自己三年前买过一次，隐约记得需要提交学生证作为认证手段。但现在最新的政策是一定年龄（阿里云24岁，腾讯云25岁）以下就自动获得学生身份，非常便捷。

金老师建议我们购买的产品应该是云服务器（阿里云称之为“ECS”，请注意**不要误选择“轻量应用服务器”**），可以选择预装CentOS 7或者是Ubuntu操作系统，购买之后可以通过SSH远程连接到服务器。因为已经在桌面设备上用过Ubuntu了，为了体验不一样的感觉，这里我选择了CentOS 7。

PS. 下一个CentOS版本，CentOS 8已于2019年底发布，阿里云（腾讯云）不日将提供更新的操作系统以供选择吧。

### 连接到云服务器

购买之后在控制面板上查看服务器的公网IP，将这个IP记录下来，随后可以通过Windows上的SSH客户端工具连接到服务器。SSH客户端工具是Windows 10自带的一项系统功能。如果电脑中提示找不到`SSH`命令，可以在“添加或删除系统功能”对话框中选中“OpenSSH工具”，让Win10自动安装这个工具。

除了Windows 10自带的SSH外，Putty也是非常流行的工具。Putty提供了友好的图形界面，并且还能发送自带SSH工具所没有的鼠标消息。

```sh
ssh root@ip-of-your-server
# 输入正确的密码就可以登录服务器了。
# 输入密码时，窗口不会回显输入的字符。
```

SSH服务器会在客户端进入沉默状态（例如，没有任何键盘输入）后的一段时间内主动断开连接。要想SSH保持连接，可以使用`-o ServerAliveInterval=60`参数，让SSH工具每隔60秒就发送keep-alive消息到服务器，以保持连接。

经过上面的步骤应该就能连接到自己的服务器了。

PS. 阿里云（腾讯云）都有保卫服务器网络安全的“安全组”规则，安全组会默认放行SSH连接所需的22端口。而如果修改了SSH连接的端口，或者因为建立网站需要用到80端口等等，都需要在控制面板的安全组设置中开放相应的端口号，否则会出现无法连接的情况。

PS2. 在我的笔记本中有[Linux常用指令笔记](https://lightyears1998.github.io/notebook/toolchain/operating-system/linux/linux-managment/)和[CentOS笔记](https://lightyears1998.github.io/notebook/toolchain/operating-system/linux/distributions/CentOS7/)。

PS3. [鳥哥的Linux私房菜網站](https://linux.vbird.org/)是内容很全面的参考站点。（虽然我曾经听身边的一些资深玩家吐槽过同名的实体书，槽点是内容过于陈旧。私以为，作为入门材料，这个网站依然具有很大的参考价值，并且鸟哥也在不断更新网站的内容。其实，孤陋寡闻的我是从鸟哥的网站上得知CentOS 8的消息的……）

### 配置全新的服务器

登录自己的服务器之后就可以使用`uname -r`确认系统的内核版本了。

```sh
$ uname -r
3.10.0-957.27.2.el7.x86_64 # 这里显示的是内核的版本。

$ cat /etc/redhat-release
CentOS Linux release 7.7.1908 (Core) # 这里显示的是CentOS的版本。
```

你是不是想知道`uname`指令为什么要使用`-r`参数呢？

在Linux系统中获取关于某个指令的帮助信息有几种方式，其一是在指令的后面附加`--help`参数，其二是使用`man`指令查询某个指令的Manual Page。例如，要获得`uname`指令的man page，可以使用`man uname`；要获得`man`指令本身的man page，可以使用`man man`指令。（并不是所有指令都有`--help`帮助信息或man page。）

```sh
some-command --help  # 显示某命令的帮助，比Manual Page简短。
man some-command     # 显示某命令的Manual Page。
info some-command    # 类似于Manual Page。
```

用最高权限的root账户进行所有的日常操作不是很靠谱，因此接下来要使用`useradd`创建日常使用的账户。

```sh
useradd lightyears -G wheel
# 以上命令创建名为lightyear的用户，并将它添加到wheel用户组。
# wheel用户组是CentOS上一个特殊的用户组，在这个用户组中的用户具有sudo权限。
# 所谓“具有sudo权限”，就是使用`sudo`指令执行一般用户不能执行的特权操作。
# 在随后步骤中要进行的“安装系统软件”操作就是特权操作之一。
```

随后就可以断开root的SSH连接了。

```sh
history # 断开连线前，查看本次连接中都执行了哪些指令。
exit
```

接下来使用新的用户名和密码连接到服务器。

```sh
ssh lightyears@server-ip
```

PS. 或许你已经注意到，在使用新的用户连接到服务器之后，“~”后的符号由“#”改变为了“$”。“$”是一般用户的标志。

```sh
[root@hostname ~]#
[lightyears@hostname ~]$
```

```sh
$ pwd # 使用pwd指令可以显示当前目录；顺带一提，root用户的主目录默认为“/root/”。
/home/lightyears
```

常用的文件操作有`pwd`、`cat`、`echo`、`ls`、`touch`、`chmod`、`rm`、`mv`、`cd`、`mkdir`等。

### 安装`gcc`

todo

## 在Windows上使用VirtualBox

todo

## 在Windows上使用Linux子系统

todo

## 在Windows上使用MSYS2

todo
